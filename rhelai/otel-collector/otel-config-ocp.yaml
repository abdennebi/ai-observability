---
receivers:
  prometheus:
    config:
      scrape_configs:
      - job_name: 'pmproxy-rhel-ai'
        scrape_interval: 5s
        static_configs:
          - targets: ['0.0.0.0:44322']
      - job_name: 'vllm'
        scrape_interval: 5s
        static_configs:
          - targets: ['0.0.0.0:8000']
  otlp:
    protocols:
      http:
      grpc:

  journald:
    units:
  #    - kepler
  #    - opentelemetry-collector
    priority: info

processors:
  batch:
  resourcedetection/system:
    detectors: ["system"]

  memory_limiter:
    check_interval: 5s
    limit_percentage: 95
    spike_limit_percentage: 25

exporters:
  otlphttp:
    endpoint: https://otlp-http-otlp-receiver-route-observability.apps.ocp-beta-test.nerc.mghpcc.org
    tls:
      insecure: false
      cert_file: /certs/server.crt
      key_file: /certs/server.key
      ca_file: /certs/ca.crt

  debug:
    verbosity: detailed

extensions:
  file_storage:
    directory: /otc
    timeout: 10s

service:
  extensions: [file_storage]
  telemetry:
    metrics:
      level: detailed
      address: 0.0.0.0:8887
  pipelines:
    traces:
      receivers: [otlp]
      processors: [batch, memory_limiter]
      exporters: [otlphttp,debug]
    metrics:
      receivers: [prometheus,otlp]
      processors: [batch, memory_limiter]
      exporters: [otlphttp, debug]
